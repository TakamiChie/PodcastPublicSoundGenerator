<!doctype html>
<html>

<head>
  <title>Podcast Public Sound Generator(PPSG)</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <h1>Podcast Public Sound Generator(PPSG)</h1>
  <form action="{{ url_for('mix') }}" method="post" enctype="multipart/form-data">
    <label for="audio">ポッドキャスト音声:</label>
    <input type="file" name="audio" id="audio" required><br><br>
    <label for="title">タイトル:</label>
    <input type="text" id="title"><br><br>
    <label for="genre">ジャンル:</label>
    <input type="text" id="genre"><br><br>
    <label for="date">配信日:</label>
    <input type="date" id="date"><br><br>
    <label for="template">カバーアートテンプレート:</label>
    <select id="template" class="savecontrol"></select><br><br>
    <label for="bgm">BGM:</label>
    <select name="bgm" id="bgm" required>
      {% for group_data in options %}
      <optgroup label="{{ group_data.group_label }}">
        {% for opt in group_data.options %}
        <option value="{{ opt.file }}">{{ opt.label }}({{ opt.stem }})</option>
        {% endfor %}
      </optgroup>
      {% endfor %}
    </select><br><br>
    <label for="target_db">目標音量(dB):</label>
    <input type="number" name="target_db" id="target_db" value="{{ target_db }}" step="0.1" class="savecontrol"><br><br>
    <button type="button" id="previewBtn">BGM視聴</button><br><br>
    <audio id="previewAudio"></audio><br>
    <button type="submit">ミックスしてダウンロード</button>
    <div id="mixProgress" class="spinner" style="display:none;"></div><br><br>
  </form>
  <h2>ミックス結果</h2>
  <label for="mixedRate">再生速度:</label>
  <select id="mixedRate" class="savecontrol">
    <option value="0.5">0.5x</option>
    <option value="1" selected>1x</option>
    <option value="1.5">1.5x</option>
    <option value="2">2x</option>
    <option value="3">3x</option>
    <option value="4">4x</option>
  </select><br><br>
  <audio id="mixedAudio" controls></audio><br>
  <a id="mixedDownload" download="mixed.mp3">ミックス音声ダウンロード</a>
  <h2>カバーアート</h2>
  <div id="coverArea"><iframe id="coverFrame"></iframe></div>
  <a id="coverDownload" href="#">カバーアートダウンロード</a>
  <script src="{{ url_for('static', filename='js/preview.js') }}"></script>
  <script src="{{ url_for('static', filename='js/savecontrol.js') }}"></script>
  <script src="{{ url_for('static', filename='js/html2canvas.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/cover.js') }}"></script>
  <script src="{{ url_for('static', filename='js/mix.js') }}"></script>
</body>

</html>